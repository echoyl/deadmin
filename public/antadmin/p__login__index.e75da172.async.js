"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[939],{61865:function(et,ne,t){t.r(ne),t.d(ne,{default:function(){return _e}});var me=t(15009),T=t.n(me),pe=t(97857),L=t.n(pe),ye=t(99289),H=t.n(ye),xe=t(5574),z=t.n(xe),c=t(1413),d=t(67294),Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zm-405.8-201c-3-4.1-7.8-6.6-13-6.6H336c-6.5 0-10.3 7.4-6.5 12.7l126.4 174a16.1 16.1 0 0026 0l212.6-292.7c3.8-5.3 0-12.7-6.5-12.7h-55.2c-5.1 0-10 2.5-13 6.6L468.9 542.4l-64.7-89.1z"}}]},name:"safety-certificate",theme:"outlined"},Ce=Se,Ze=t(91146),re=function(r,i){return d.createElement(Ze.Z,(0,c.Z)((0,c.Z)({},r),{},{ref:i,icon:Ce}))};re.displayName="SafetyCertificateOutlined";var je=d.forwardRef(re),X=t(45360),Pe=t(42075),ie=t(96365),se=t(15867),Fe=t(57953),V=t(33067),e=t(85893),Be=function(r){var i=r.value,S=i===void 0?{}:i,Z=r.onChange,a=r.reload,j=a===void 0?0:a,b=r.placeholder,N=b===void 0?"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801":b,F=(0,d.useState)(""),B=z()(F,2),y=B[0],$=B[1],O=(0,d.useState)(""),R=z()(O,2),D=R[0],w=R[1],E=(0,d.useState)(""),x=z()(E,2),g=x[0],A=x[1],k=(0,d.useState)(!1),P=z()(k,2),M=P[0],I=P[1],h=function(){var v=H()(T()().mark(function C(){var p;return T()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,V.xx)({key:D});case 3:if(p=u.sent,p.code!==0){u.next=6;break}return u.abrupt("return",p.data);case 6:u.next=12;break;case 8:return u.prev=8,u.t0=u.catch(0),X.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),u.abrupt("return",[]);case 12:return X.ZP.error("\u83B7\u53D6\u90E8\u95E8\u6811\u5931\u8D25,\u8BF7\u91CD\u8BD5"),u.abrupt("return",[]);case 14:case"end":return u.stop()}},C,null,[[0,8]])}));return function(){return v.apply(this,arguments)}}(),s=function(C){Z&&Z(L()(L()({captchaCode:y,captchaKey:D},S),C))},l=function(C){I(!0),h().then(function(p){I(!1),w(p.key),A(p.img),C&&s({captchaKey:p.key})})};(0,d.useEffect)(function(){l(!1)},[]),(0,d.useEffect)(function(){j>0&&l(!0)},[j]);var o=function(C){var p=C.target.value||"";p&&$(p),s({captchaCode:p})},m=function(){l(!0)};return(0,e.jsxs)(Pe.Z,{children:[(0,e.jsx)(ie.Z,{prefix:(0,e.jsx)(je,{}),size:"large",placeholder:N,onChange:o}),(0,e.jsx)(se.ZP,{size:"large",style:{overflow:"hidden",padding:0,width:112},children:(0,e.jsx)(Fe.Z,{spinning:M,size:"small",children:(0,e.jsx)("img",{src:g,onClick:m})})})]})},le=Be,Ie=t(99702),oe=t(87547),ue=t(94149),Te=t(84517),J=t(5966),Q=t(34994),be=t(97462),U=t(74165),ce=t(15861),q=t(91),_=t(97685),Re=t(40741),de=t(90789),Ae=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],Le=d.forwardRef(function(n,r){var i=Re.Z.useFormInstance(),S=(0,d.useState)(n.countDown||60),Z=(0,_.Z)(S,2),a=Z[0],j=Z[1],b=(0,d.useState)(!1),N=(0,_.Z)(b,2),F=N[0],B=N[1],y=(0,d.useState)(),$=(0,_.Z)(y,2),O=$[0],R=$[1],D=n.rules,w=n.name,E=n.phoneName,x=n.fieldProps,g=n.onTiming,A=n.captchaTextRender,k=A===void 0?function(h,s){return h?"".concat(s," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:A,P=n.captchaProps,M=(0,q.Z)(n,Ae),I=function(){var h=(0,ce.Z)((0,U.Z)().mark(function s(l){return(0,U.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,R(!0),m.next=4,M.onGetCaptcha(l);case 4:R(!1),B(!0),m.next=13;break;case 8:m.prev=8,m.t0=m.catch(0),B(!1),R(!1),console.log(m.t0);case 13:case"end":return m.stop()}},s,null,[[0,8]])}));return function(l){return h.apply(this,arguments)}}();return(0,d.useImperativeHandle)(r,function(){return{startTiming:function(){return B(!0)},endTiming:function(){return B(!1)}}}),(0,d.useEffect)(function(){var h=0,s=n.countDown;return F&&(h=window.setInterval(function(){j(function(l){return l<=1?(B(!1),clearInterval(h),s||60):l-1})},1e3)),function(){return clearInterval(h)}},[F]),(0,d.useEffect)(function(){g&&g(a)},[a,g]),(0,e.jsxs)("div",{style:(0,c.Z)((0,c.Z)({},x==null?void 0:x.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[(0,e.jsx)(ie.Z,(0,c.Z)((0,c.Z)({},x),{},{style:(0,c.Z)({flex:1,transition:"width .3s",marginRight:8},x==null?void 0:x.style)})),(0,e.jsx)(se.ZP,(0,c.Z)((0,c.Z)({style:{display:"block"},disabled:F,loading:O},P),{},{onClick:(0,ce.Z)((0,U.Z)().mark(function h(){var s;return(0,U.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,!E){o.next=9;break}return o.next=4,i.validateFields([E].flat(1));case 4:return s=i.getFieldValue([E].flat(1)),o.next=7,I(s);case 7:o.next=11;break;case 9:return o.next=11,I("");case 11:o.next=16;break;case 13:o.prev=13,o.t0=o.catch(0),console.log(o.t0);case 16:case"end":return o.stop()}},h,null,[[0,13]])})),children:k(F,a)}))]})}),Ne=(0,de.G)(Le),De=Ne,Ee=t(10915),ze=t(94740),$e=t(94184),ke=t.n($e),ee=t(4942),Me=t(98082),we=function(r){var i;return i={},(0,ee.Z)(i,r.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:r.colorTextSecondary,fontSize:r.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),(0,ee.Z)(i,"@media (min-width: @screen-md-min)",(0,ee.Z)({},"".concat(r.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"})),i};function Ge(n){return(0,Me.Xj)("LoginForm",function(r){var i=(0,c.Z)((0,c.Z)({},r),{},{componentCls:".".concat(n)});return[we(i)]})}var Oe=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function He(n){var r,i=n.logo,S=n.message,Z=n.contentStyle,a=n.title,j=n.subTitle,b=n.actions,N=n.children,F=n.containerStyle,B=n.otherStyle,y=(0,q.Z)(n,Oe),$=(0,Ee.YB)(),O=y.submitter===!1?!1:(0,c.Z)((0,c.Z)({searchConfig:{submitText:$.getMessage("loginForm.submitText","\u767B\u5F55")}},y.submitter),{},{submitButtonProps:(0,c.Z)({size:"large",style:{width:"100%"}},(r=y.submitter)===null||r===void 0?void 0:r.submitButtonProps),render:function(P,M){var I,h=M.pop();if(typeof(y==null||(I=y.submitter)===null||I===void 0?void 0:I.render)=="function"){var s,l;return y==null||(s=y.submitter)===null||s===void 0||(l=s.render)===null||l===void 0?void 0:l.call(s,P,M)}return h}}),R=(0,d.useContext)(ze.ZP.ConfigContext),D=R.getPrefixCls("pro-form-login"),w=Ge(D),E=w.wrapSSR,x=w.hashId,g=function(P){return"".concat(D,"-").concat(P," ").concat(x)},A=(0,d.useMemo)(function(){return i?typeof i=="string"?(0,e.jsx)("img",{src:i}):i:null},[i]);return E((0,e.jsxs)("div",{className:ke()(g("container"),x),style:F,children:[(0,e.jsxs)("div",{className:"".concat(g("top")," ").concat(x).trim(),children:[a||A?(0,e.jsxs)("div",{className:"".concat(g("header")),children:[A?(0,e.jsx)("span",{className:g("logo"),children:A}):null,a?(0,e.jsx)("span",{className:g("title"),children:a}):null]}):null,j?(0,e.jsx)("div",{className:g("desc"),children:j}):null]}),(0,e.jsxs)("div",{className:g("main"),style:(0,c.Z)({width:328},Z),children:[(0,e.jsxs)(Q.A,(0,c.Z)((0,c.Z)({isKeyPressSubmit:!0},y),{},{submitter:O,children:[S,N]})),b?(0,e.jsx)("div",{className:g("main-other"),style:B,children:b}):null]})]}))}var ve=t(22270),Ke=t(84567),fe=t(19323),We=["options","fieldProps","proFieldProps","valueEnum"],Ve=d.forwardRef(function(n,r){var i=n.options,S=n.fieldProps,Z=n.proFieldProps,a=n.valueEnum,j=(0,q.Z)(n,We);return(0,e.jsx)(fe.Z,(0,c.Z)({ref:r,valueType:"checkbox",valueEnum:(0,ve.h)(a,void 0),fieldProps:(0,c.Z)({options:i},S),lightProps:(0,c.Z)({labelFormatter:function(){return(0,e.jsx)(fe.Z,(0,c.Z)({ref:r,valueType:"checkbox",mode:"read",valueEnum:(0,ve.h)(a,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,c.Z)({options:i},S),proFieldProps:Z},j))}},j.lightProps),proFieldProps:Z},j))}),Ue=d.forwardRef(function(n,r){var i=n.fieldProps,S=n.children;return(0,e.jsx)(Ke.Z,(0,c.Z)((0,c.Z)({ref:r},i),{},{children:S}))}),Ye=(0,de.G)(Ue,{valuePropName:"checked"}),ge=Ye;ge.Group=Ve;var Xe=ge,K=t(7837),Je=t(48096),Qe=t(73935),W={container:"container___ldtvs",lang:"lang___qrAB8",content:"content___wB3e_",icon:"icon___CBYA8"},tt=function(r){var i=r.content;return _jsx(Alert,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},qe=function(){var r,i,S,Z=(0,K.useModel)("@@initialState"),a=Z.initialState,j=Z.setInitialState,b=(0,d.useState)(0),N=z()(b,2),F=N[0],B=N[1],y=(0,K.useSearchParams)(),$=z()(y,1),O=$[0],R=X.ZP.useMessage(),D=z()(R,2),w=D[0],E=D[1],x=function(){var s=H()(T()().mark(function l(o){return T()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,V.ZP.post("login",{data:L()(L()({},o),{},{loginType:P}),duration:1,msgcls:function(){var C=H()(T()().mark(function G(u){return T()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:u.code?(console.log("reload captcha"),B(F+1)):u.code||(o.autoLogin?localStorage.setItem("Sa-Remember","1"):localStorage.setItem("Sa-Remember","0"),localStorage.setItem(V.lH,u.data.access_token),(0,Qe.flushSync)(function(){j(function(f){return L()(L()({},f),{},{currentUser:u.data.userinfo,settings:L()(L()({},f==null?void 0:f.settings),u.data.setting)})}).then(function(){var f,he="/";if(u.data.userinfo.redirect)K.history.push(u.data.userinfo.redirect);else if(a!=null&&(f=a.settings)!==null&&f!==void 0&&f.baseurl){var ae;K.history.push(he.replace(a==null||(ae=a.settings)===null||ae===void 0?void 0:ae.baseurl,"/"))}else K.history.push(he)})}));case 1:case"end":return Y.stop()}},G)}));function p(G){return C.apply(this,arguments)}return p}()});case 2:return v.abrupt("return");case 3:case"end":return v.stop()}},l)}));return function(o){return s.apply(this,arguments)}}(),g={},A=(0,d.useState)(a==null||(r=a.settings)===null||r===void 0?void 0:r.loginTypeDefault),k=z()(A,2),P=k[0],M=k[1];a!=null&&(i=a.settings)!==null&&i!==void 0&&i.loginBgImgage&&(g.backgroundImage='url("'+(a==null?void 0:a.settings.loginBgImgage)+'")');var I=(0,d.useRef)(),h=[{label:"\u624B\u673A\u53F7\u767B\u5F55",key:"phone",children:P!="phone"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(J.Z,{name:"mobile",fieldProps:{size:"large",prefix:(0,e.jsx)(oe.Z,{className:W.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"},{pattern:/^1\d{10}$/,message:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"}]}),(0,e.jsx)(Q.A.Item,{name:"captcha",rules:[{required:!0,message:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(le,{reload:F,placeholder:"\u83B7\u53D6\u624B\u673A\u9A8C\u8BC1\u7801\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801"})}),(0,e.jsx)(be.Z,{name:["captcha"],children:function(l){var o=l.captcha;return(0,e.jsx)(De,{fieldProps:{size:"large",prefix:(0,e.jsx)(ue.Z,{})},countDown:60,captchaProps:{size:"large"},phoneName:"mobile",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",captchaTextRender:function(v,C){return v?"".concat(C," \u83B7\u53D6\u9A8C\u8BC1\u7801"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"},name:"mobilecode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"}],onGetCaptcha:function(){var m=H()(T()().mark(function v(C){var p,G,u,te;return T()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,(p=I.current)===null||p===void 0?void 0:p.validateFields(["captcha"]);case 3:f.next=8;break;case 5:throw f.prev=5,f.t0=f.catch(0),new Error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 8:return f.next=10,V.ZP.post("sms",{data:{mobile:C,captcha:o}});case 10:if(G=f.sent,u=G.code,te=G.msg,!u){f.next=15;break}throw new Error(te);case 15:case"end":return f.stop()}},v,null,[[0,5]])}));return function(v){return m.apply(this,arguments)}}()})}})]})},{label:"\u8D26\u53F7\u5BC6\u7801\u767B\u5F55",key:"password",children:P!="password"?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(J.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(oe.Z,{className:W.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]}),(0,e.jsx)(J.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(ue.Z,{className:W.prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(Q.A.Item,{name:"captcha",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}],children:(0,e.jsx)(le,{reload:F})})]})}];return(0,e.jsxs)("div",{className:W.container,style:L()({},g),children:[(0,e.jsx)("div",{className:W.content,children:(0,e.jsxs)(Te.ZP,{style:{maxWidth:440,margin:"60px auto",padding:"20px 0",background:g.backgroundImage?"#fff":"none"},children:[E,(0,e.jsxs)(He,{formRef:I,logo:a==null?void 0:a.settings.logo,title:a==null?void 0:a.settings.title,subTitle:a==null?void 0:a.settings.subtitle,initialValues:{autoLogin:!0},onFinish:function(){var s=H()(T()().mark(function l(o){return T()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,x(o);case 2:case"end":return v.stop()}},l)}));return function(l){return s.apply(this,arguments)}}(),children:[(0,e.jsx)(Je.Z,{centered:!0,activeKey:P,onChange:function(l){return M(l)},items:a==null||(S=a.settings.loginType)===null||S===void 0?void 0:S.map(function(s){return h.find(function(l){return l.key==s})})}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(Xe,{noStyle:!0,name:"autoLogin",children:"\u81EA\u52A8\u767B\u5F55"}),(0,e.jsx)("a",{style:{float:"right"},onClick:function(){w.info("\u8BF7\u4F7F\u7528\u624B\u673A\u53F7\u767B\u5F55\u540E\u4FEE\u6539,\u6216\u8054\u7CFB\u540E\u53F0\u7BA1\u7406\u5458\u4FEE\u6539\u8D26\u53F7\u5BC6\u7801\uFF01")},children:"\u5FD8\u8BB0\u5BC6\u7801"})]})]})]})}),(0,e.jsx)(Ie.Z,{})]})},_e=qe}}]);
