"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[571],{6145:function(Oe,$,t){t.r($),t.d($,{default:function(){return Ke}});var w=t(97857),r=t.n(w),b=t(86488),_=t(15009),G=t.n(_),ee=t(99289),te=t.n(ee),ae=t(5574),T=t.n(ae),ne=t(33067),L=t(38345),le=t(16968),W=t(1524),V=t(13943),Z=t(7837),J=t(27076),se=t(63430),re=t(79611),ie=t(78677),oe=t(49787),de=t(80652),ue=t(98165),ve=t(99559),fe=t(7134),Y=t(71230),P=t(15746),Q=t(15867),me=t(3321),X=t(86250),ce=t(48096),ge=t(45582),he=t(27484),k=t.n(he),F=t(67294),xe=t(13208),ye=t(33237),pe=t(17003),z={pageHeaderContent:"pageHeaderContent___exWxI",avatar:"avatar___rptEO",content:"content___jBAzR",contentTitle:"contentTitle___TsVhT",extraContent:"extraContent___tNqx0",statItem:"statItem___jPU6u"},e=t(85893),je=function(o){var f=(0,Z.useModel)("@@initialState"),l=f.initialState,i=l.currentUser,s=i&&Object.keys(i).length;return s?(0,e.jsxs)("div",{className:z.pageHeaderContent,children:[(0,e.jsx)("div",{className:z.avatar,children:(0,e.jsx)(fe.C,{size:"large",src:i.avatar?i.avatar:l==null?void 0:l.settings.logo})}),(0,e.jsxs)("div",{className:z.content,children:[(0,e.jsx)("div",{className:z.contentTitle,children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsxs)(P.Z,{span:12,children:["\u4F60\u597D\uFF0C",i.realname?i.realname:i.name]}),(0,e.jsx)(P.Z,{span:12,style:{textAlign:"right"},children:(0,e.jsx)(Se,{})})]})}),(0,e.jsxs)("div",{children:[i.rolename," ",(0,e.jsx)(Q.ZP,{shape:"circle",type:"text",onClick:function(){var m;(m=o.flash)===null||m===void 0||m.call(o)},icon:(0,e.jsx)(ue.Z,{})})]})]})]}):(0,e.jsx)(ve.Z,{avatar:!0,paragraph:{rows:1},active:!0})},Se=function(){var o=(0,F.useState)(k()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),f=T()(o,2),l=f[0],i=f[1],s=function d(){i(k()().format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss dddd")),setTimeout(function(){return d()},1e3)};return setTimeout(function(){return s()},1e3),(0,e.jsx)(e.Fragment,{children:l})},Ze=function(o){var f=o.url,l=f===void 0?"":f,i=(0,F.useState)(),s=T()(i,2),d=s[0],m=s[1],N=me.Z.useApp(),C=N.message,M=(0,F.useState)(),A=T()(M,2),B=A[0],D=A[1],I=(0,Z.useModel)("@@initialState"),K=I.initialState,H=function(){var a=te()(G()().mark(function n(){var v,g,c,p=arguments;return G()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return v=p.length>0&&p[0]!==void 0?p[0]:{},C.loading("\u52A0\u8F7D\u4E2D..."),u.next=4,ne.ZP.get(l,{params:r()(r()({},B),v),then:function(){}});case 4:g=u.sent,c=g.data,C.destroy(),m(c);case 8:case"end":return u.stop()}},n)}));return function(){return a.apply(this,arguments)}}();(0,F.useEffect)(function(){H()},[]);var O=function(n){var v=n.type;if(v=="pie")return(0,e.jsx)(se.Z,r()({height:280,appendPadding:10,data:n.data,radius:.9,label:{type:"inner",offset:"-30%",content:function(p){var S=p.percent;return"".concat((S*100).toFixed(0),"%")},style:{fontSize:14,textAlign:"center"}},interactions:[{type:"element-active"}]},n.config));if(v=="bar")return(0,e.jsx)(re.Z,r()({xField:"x",yField:"y",data:n.data},n.config));if(v=="column")return(0,e.jsx)(ie.Z,r()({xField:"x",yField:"y",data:n.data},n.config));if(v=="areaMap"){var g=r()({map:{type:"mapbox",style:"blank",center:[120.19382669582967,30.258134],zoom:13,pitch:0},source:{data:n.data,parser:{type:"geojson"}},autoFit:!0,color:{field:n.field,value:["#1A4397","#3165D1","#6296FE","#98B7F7","#DDE6F7","#F2F5FC"].reverse(),scale:{type:"quantile"}},style:{opacity:1,stroke:"#eee",lineWidth:.8,lineOpacity:1},state:{active:!0,select:{stroke:"blue",lineWidth:1.5,lineOpacity:.8}},label:{visible:!0,field:"name",style:{fill:"black",opacity:.5,fontSize:12,spacing:1,padding:[15,15]}},zoom:{position:"bottomright"},legend:{position:"bottomleft"}},n.config);return(0,e.jsx)("div",{style:{width:"100%",height:500},children:(0,e.jsx)(oe.Z,r()({},g))})}else return(0,e.jsx)(de.Z,r()({smooth:!0,height:280,data:n.data,xField:"x",yField:"y",title:{visible:!0,text:n.title,style:{fontSize:14}},meta:{y:{alias:n.y}},label:{content:function(p){return p.y},position:"top",style:{fill:"#000000",opacity:.6}}},n.config))},U=function a(n,v){var g;return(0,e.jsx)(X.Z,{vertical:!0,gap:"middle",children:n==null||(g=n.row)===null||g===void 0?void 0:g.map(function(c,p){var S;return(0,e.jsxs)(Y.Z,{gutter:[16,16],children:[c.form?(0,e.jsx)(P.Z,{span:24,children:(0,e.jsx)(L.Z,{style:{marginBottom:-16,borderBottomRightRadius:0,borderBottomLeftRadius:0},bodyStyle:{paddingBottom:0},children:(0,e.jsx)(le.Z,{layoutType:"LightFilter",bordered:!0,columns:(0,ye.ab)({initRequest:!0,columns:c.form.columns}),initialValues:B||c.form.value,onFinish:function(h){D(h),H(h),console.log("onFinish",h)}})})},p+"form"):null,c==null||(S=c.col)===null||S===void 0?void 0:S.map(function(u,h){if(u.row){var E;return(0,e.jsx)(P.Z,{span:u.span?u.span:24/((E=c.col)===null||E===void 0?void 0:E.length),children:a(u,v)},h)}else if(u.tab){var x;return(0,e.jsx)(P.Z,{span:u.span?u.span:24/((x=c.col)===null||x===void 0?void 0:x.length),children:(0,e.jsx)(L.Z,{style:{borderTopRightRadius:0,borderTopLeftRadius:0},children:(0,e.jsx)(ce.Z,{style:{background:"#fff"},tabBarStyle:{paddingLeft:0,marginBottom:0},items:u.tab.map(function(j,q){return{key:q,label:j.title,children:j.row?a(j,v):v(j,q,{notitle:!0})}})})},h)},h)}else{var y;return(0,e.jsx)(P.Z,{span:u.span?u.span:24/((y=c.col)===null||y===void 0?void 0:y.length),children:v(u,h)},h)}})]},p)})})};return(0,e.jsx)(W._z,{title:!1,className:"saContainer",fixedHeader:J.P.fixedHeader,header:{breadcrumbRender:function(n,v){return(0,e.jsx)(b.Lr,{})}},children:(0,e.jsxs)(X.Z,{vertical:!0,gap:"middle",children:[(0,e.jsx)(L.Z,{children:(0,e.jsx)(je,{flash:H})},"headcard"),U(d,function(a,n,v){return a.type=="card"?(0,e.jsx)(V.Z,{style:{height:"100%"},statistic:{title:a.title,value:a.value,prefix:a.prefix,suffix:a.suffix,description:a.href?(0,e.jsx)(Z.Link,{to:a.href,style:{fontSize:12},children:"\u67E5\u770B\u66F4\u591A"}):""}},n+"card"):a.type=="table"?(0,e.jsx)(L.Z,{style:{height:"100%"},children:(0,e.jsx)(ge.Z,r()({columns:(0,pe.S)({initRequest:!0,columns:a.columns,initialState:K}),dataSource:a.data,title:function(){return a.title},rowKey:"id"},a.props))},n+"table"):a.type=="mapDots"?(0,e.jsx)(L.Z,{title:a.title,style:{height:"100%"},children:(0,e.jsx)(xe.O1,r()(r()({},a.props),{},{dots:a.data}))},n+"mapDots"):(0,e.jsx)(V.Z,{style:{height:"100%"},title:v!=null&&v.notitle?(0,e.jsx)("div",{style:{height:20}}):a.title,chart:O(a)},n+"chart")})]})})},Pe=Ze,Fe=t(19632),Ce=t.n(Fe),Te=t(9783),De=t.n(Te),Ee=t(95038),Re=t(34528),Ue=t(21655),Ne=t(14534),Ae=function(o){var f=o.tableTitle,l=f===void 0?!1:f,i=o.path,s=o.leftMenu,d=s===void 0?{name:"categorys",url_name:"category_id",title:"\u5206\u7C7B\u9009\u62E9",field:{title:"label",key:"value"}}:s,m=d?d.name:"",N=d?d.title:"",C=d?d.url_name:"",M=d?d.field:!1,A=(0,F.useState)([]),B=T()(A,2),D=B[0],I=B[1],K=(0,Z.useSearchParams)(),H=T()(K,2),O=H[0],U=H[1],a=O.get(C),n=(0,F.useState)(a?isNaN(a)?a:parseInt(a):0),v=T()(n,2),g=v[0],c=v[1],p=(0,F.useState)([]),S=T()(p,2),u=S[0],h=S[1];return(0,e.jsx)(W._z,{title:l,className:"saContainer",fixedHeader:J.P.fixedHeader,header:{breadcrumbRender:function(x,y){return(0,e.jsx)(b.Lr,{path:i})}},children:(0,e.jsxs)(Y.Z,{gutter:[24,16],style:D.length>1?{marginLeft:0,marginRight:0}:{},children:[D.length>1&&(0,e.jsxs)(P.Z,{span:3,title:N,style:{background:"#fff",paddingTop:20},children:[(0,e.jsx)(Re.Z,{level:5,children:N}),(0,e.jsx)(Ee.Z,{selectedKeys:[g],expandedKeys:u,treeData:D,fieldNames:M,onSelect:function(x){var y=0;x.length>0&&(y=x.pop()),c(y);var j=(0,b.Cc)([C]);y&&(j[C]=y+""),U(r()({},j))},onExpand:function(x){h(x)}})]}),(0,e.jsx)(P.Z,{span:D.length>1?21:24,children:(0,e.jsx)(Ne.ZP,r()(r()({},o),{},{paramExtra:g?r()(r()({},o.paramExtra),{},De()({},C,g)):r()({},o.paramExtra),beforeTableGet:function(x){var y;if(d&&!(D.length>0||!((y=x.search)!==null&&y!==void 0&&y[m]))&&(I(Ce()(x.search[m])),g&&u.length<1)){var j=(0,b.aT)(x.search[m],g,{id:"value",children:"children"});console.log(j,111),h(j)}},tableProps:o.tableProps}))})]})})},Be=Ae,He=t(32250),be=t(72644),Le=t(83832),Me=t(29905),ze=function(){return(0,e.jsx)(Me.ZP,{status:"403",title:"403",subTitle:"\u4F60\u6CA1\u6709\u6B64\u9875\u9762\u7684\u8BBF\u95EE\u6743\u9650",extra:(0,e.jsx)(Q.ZP,{type:"primary",onClick:function(){return Z.history.push("/")},children:"\u8FD4\u56DE\u5DE5\u4F5C\u53F0"})})},Ye=function(){var o,f=(0,Z.useLocation)(),l=f.pathname,i=l.match(/\/(\d+)$/);i&&(l=f.pathname.replace(i[0],""));var s=(0,b.Sj)(l);return s?((0,F.useEffect)(function(){var d;if((d=s.data)!==null&&d!==void 0&&d.redirect){var m;Z.history.push((m=s.data)===null||m===void 0?void 0:m.redirect)}},[s]),(0,e.jsx)(e.Fragment,{children:(o=s.data)!==null&&o!==void 0&&o.redirect?(0,e.jsx)(Le.S,{}):(0,e.jsx)(Ie,{menu:s,match:i,pathname:l})})):(0,e.jsx)(ze,{})},Ie=function(o){var f=o.menu,l=o.match,i=o.pathname,s=f.data,d=f.page_type,m=f.name;if(l||d=="form"){var N=(s.postUrl?s.postUrl:s.url+"/show")+(l?"?id="+(l==null?void 0:l[1]):"");return(0,e.jsx)(be.Z,r()(r()({formTitle:!1},s),{},{msgcls:function(M){var A=M.code;s.noBack||A||d!="form"&&Z.history.back()},url:N,match:!!l,dataId:l?l==null?void 0:l[1]:0}),i)}else switch(d){case"category":return(0,e.jsx)(He.Z,r()(r()({path:i,name:m},s),{},{tableTitle:!1}),i);case"table":return(0,e.jsx)(Be,r()(r()({path:i,name:m},s),{},{tableTitle:!1}),i);case"panel":return(0,e.jsx)(Pe,r()({},s));default:return null}},Ke=Ye}}]);
